# RemedyIQ Environment Configuration
# Copy this file to .env and update values for your environment

#############################################
# Application
#############################################

# Environment: development, staging, production
APP_ENV=development

# Server configuration
API_PORT=8080
API_HOST=0.0.0.0

# Logging level: debug, info, warn, error
LOG_LEVEL=debug

# CORS allowed origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:8080

#############################################
# PostgreSQL - Primary Database
#############################################

# Connection string format: postgres://user:password@host:port/dbname?sslmode=disable
POSTGRES_URL=postgres://remedyiq:remedyiq@localhost:5432/remedyiq?sslmode=disable

# Individual components (used by docker-compose)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=remedyiq
POSTGRES_USER=remedyiq
POSTGRES_PASSWORD=remedyiq

# Connection pool settings
POSTGRES_MAX_OPEN_CONNS=25
POSTGRES_MAX_IDLE_CONNS=5
POSTGRES_CONN_MAX_LIFETIME=300s

#############################################
# ClickHouse - Analytics Database
#############################################

# HTTP interface (for queries)
CLICKHOUSE_HOST=localhost
CLICKHOUSE_HTTP_PORT=8123
CLICKHOUSE_NATIVE_PORT=9004
CLICKHOUSE_DB=remedyiq
CLICKHOUSE_USER=default
CLICKHOUSE_PASSWORD=

# Connection settings
CLICKHOUSE_MAX_OPEN_CONNS=10
CLICKHOUSE_COMPRESS=true

#############################################
# NATS - Message Queue
#############################################

# NATS server URL
NATS_URL=nats://localhost:4222

# JetStream stream names
NATS_STREAM_JOBS=JOBS
NATS_STREAM_EVENTS=EVENTS

# Consumer configuration
NATS_CONSUMER_GROUP=remedyiq-workers
NATS_MAX_DELIVER=3
NATS_ACK_WAIT=300s

#############################################
# Redis - Cache & Session Store
#############################################

# Redis connection
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Cache TTL (in seconds)
REDIS_DEFAULT_TTL=3600
REDIS_SESSION_TTL=86400

# Connection pool
REDIS_POOL_SIZE=10
REDIS_MIN_IDLE_CONNS=2

#############################################
# MinIO - Object Storage (S3-compatible)
#############################################

# MinIO endpoint (API port)
MINIO_ENDPOINT=localhost:9002
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_USE_SSL=false

# Bucket names
MINIO_BUCKET_UPLOADS=remedyiq-uploads
MINIO_BUCKET_REPORTS=remedyiq-reports
MINIO_BUCKET_TEMP=remedyiq-temp

# Region (can be any value for MinIO)
MINIO_REGION=us-east-1

#############################################
# ARLogAnalyzer Integration
#############################################

# Path to ARLogAnalyzer.jar (relative to backend/ directory for local dev)
ARLOG_JAR_PATH=../ARLogAnalyzer.jar

# JVM heap size for analysis (e.g., 20GB for large logs)
ARLOG_HEAP_SIZE=20g

# Temporary directory for analysis workspace
ARLOG_TEMP_DIR=/tmp/remedyiq-analysis

# Analysis timeout (in seconds)
ARLOG_TIMEOUT=3600

#############################################
# Claude AI Integration
#############################################

# Anthropic API key
ANTHROPIC_API_KEY=sk-ant-api03-...

# Model configuration
CLAUDE_MODEL=claude-opus-4-6
CLAUDE_MAX_TOKENS=4096
CLAUDE_TEMPERATURE=0.7

# Rate limiting
CLAUDE_MAX_REQUESTS_PER_MINUTE=50
CLAUDE_MAX_CONCURRENT_REQUESTS=5

#############################################
# Authentication & Security
#############################################

# JWT secret (generate with: openssl rand -base64 32)
JWT_SECRET=change-me-in-production

# JWT expiration times
JWT_ACCESS_TOKEN_TTL=15m
JWT_REFRESH_TOKEN_TTL=7d

# Session cookie settings
SESSION_SECRET=change-me-in-production
SESSION_COOKIE_NAME=remedyiq_session
SESSION_COOKIE_SECURE=false
SESSION_COOKIE_HTTP_ONLY=true

# Password hashing (bcrypt cost)
BCRYPT_COST=10

#############################################
# File Upload Configuration
#############################################

# Max upload size in MB
MAX_UPLOAD_SIZE_MB=1000

# Allowed file extensions (comma-separated)
ALLOWED_EXTENSIONS=.log,.zip,.gz,.tar,.tar.gz

# Upload processing
UPLOAD_CHUNK_SIZE_MB=10
UPLOAD_CONCURRENT_CHUNKS=4

#############################################
# Worker Configuration
#############################################

# Number of concurrent workers
WORKER_CONCURRENCY=4

# Job retry configuration
WORKER_MAX_RETRIES=3
WORKER_RETRY_DELAY=30s

# Health check interval
WORKER_HEALTH_CHECK_INTERVAL=30s

#############################################
# Monitoring & Observability
#############################################

# Metrics endpoint
METRICS_ENABLED=true
METRICS_PORT=9090

# Health check endpoint
HEALTH_CHECK_ENABLED=true

# Distributed tracing (optional)
JAEGER_ENABLED=false
JAEGER_ENDPOINT=http://localhost:14268/api/traces

#############################################
# Development Tools
#############################################

# Enable hot reload
HOT_RELOAD=true

# Enable debug endpoints
DEBUG_ENDPOINTS=true

# Enable SQL query logging
LOG_SQL_QUERIES=false

# Enable profiling endpoints (pprof)
ENABLE_PROFILING=true
PROFILING_PORT=6060
